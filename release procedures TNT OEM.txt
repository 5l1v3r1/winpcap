OEM WINPCAP TOOLKIT RELEASE PROCEDURE
=====================================

Needed tools
------------
- Visual Studio .NET 2003
- The cygnus environment on your path (needed to execute step 10 and 11).


How to compile OEM WinPcap for the toolkit.
-------------------------------------------

1.  Download winpcap (HEAD) and winpcap_oem from the CVS into %BUILD_TREE%

2.  Modify the version info into
	  %BUILD_TREE%\winpcap_oem\version.h. The version for the TNT is x.y.1.z

3.  Modify the device string into
	  %BUILD_TREE%\winpcap\common\wpcapnames.h (first two defines)

4.  Download the libpcap sources (usually 0_9 branch) into 
	  %BUILD_TREE%\libpcap_<version>

5.  Commit %BUILD_TREE%\winpcap_oem\version.h into the CVS. This should be the 
    *only* modified file in this module.

6.  Tag the %BUILD_TREE%\winpcap_oem module with the tag 
	  OEM_WINPCAP_<version>_TNT_<TNT version>

7.  Tag the %BUILD_TREE%\winpcap module with the tag 
	  OEM_WINPCAP_<version>_TNT_<TNT version>

8.  Take the contents of %BUILD_TREE%\libpcap_<version> and copy it into
	  %BUILD_TREE%\winpcap\wpcap\libpcap 
	(confirm the overwrite operation)

9.  From the command line, go to folder 
      %BUILD_TREE%\winpcap\wpcap\libpcap

10. On the command line, type "patch -p1 < remote_code.patch"

11. CD into %BUILD_TREE%\winpcap\wpcap\prj and execute 
	"build_scanner_parser.bat"	

12. Zip the contents of the three folders 
	  %BUILD_TREE%\winpcap_oem
	  %BUILD_TREE%\winpcap
	  %BUILD_TREE%\libpcap_<libpcap_version>
		  |
		  V
	  %BUILD_TREE%\sources.zip

13. Open a Win 2000 DDK Free build environment. Go into 
	  %BUILD_TREE%\winpcap_oem\packetntx. 
	Execute "compile2k_oem.bat". Prefast 1.5.2402 should issue 18 warnings (20060222). 
	Close the build environment.

14. Open the WinNT4 DDK Release build environment. Go into 
      %BUILD_TREE%\winpcap_oem\packetntx. 
    Execute "compileNT4_oem.bat". An error "The system cannot find the file 
    specified" should be issued (20060126), it's normal. Close the build 
    environment. 
    NOTE: DO NOT EXECUTE 16. and 17. at the same time, they overwrite files in 
    the build process that are incompatible between the two builds.

15. Open %BUILD_TREE%\winpcap_oem\WinPcap OEM.sln with Visual Studio 2003. 
    Choose the Debug_TNT configuration, and then use Build->Rebuild Solution. 
    NOTE: a linker warning (LNK4075: ignoring EDITANDCONTINUE...) should be 
    issued. 
    Choose the Release_TNT configuration, and then use Build->Rebuild Solution.
    Some warnings should be issued related to the wpcap.dll project, only.
    Close Visual Studio.

16. The build is complete.
	The DLLs are in the following folders:

		%BUILD_TREE%\winpcap_oem\wpcap\PRJ\release_REMOTE_TNT\wpcap.dll
		%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\Release_TNT\packet.dll

17. Check the DLLs/SYSs files for the versions
		%BUILD_TREE%\winpcap_oem\wpcap\PRJ\release_REMOTE_TNT\wpcap.dll
		%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\Release_TNT\packet.dll
		%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\binaries\npf2k.sys
		%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\binaries\npfnt.sys
		%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\binaries\packet2k.sys
		%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\binaries\packetnt.sys


SCM procedures
--------------

1.  %BUILD_TREE%\winpcap_oem\wpcap\PRJ\release_REMOTE_TNT\wpcap.dll
	%BUILD_TREE%\winpcap_oem\OEM\WinpcapOem\Release_TNT\packet.dll
		|
		v
	OEM_WinPcap_<version>_TNT_<TNT version>_Binaries.zip

2. 	%BUILD_TREE%\Sources.zip
		|
		V
	OEM_WinPcap_<version>_TNT_<TNT version>_Sources.zip

3.  %BUILD_TREE%\
		|
		V
	OEM_WinPcap_<version>_TNT_<TNT version>_Build_Tree.zip
		